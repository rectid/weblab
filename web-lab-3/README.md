# Social Admin Panel

Простая админ-панель социальной сети на Node.js/Express с шаблонами EJS. Приложение хранит данные пользователей в JSON-файлах, поддерживает HTTPS и предоставляет две независимые сборки клиентской части на Gulp и Webpack.

## Возможности

- Управление пользователями: редактирование профиля, изменение роли (админ/пользователь) и статуса (ожидает, активен, заблокирован), добавление и удаление.
- Работа с друзьями: просмотр списка друзей пользователя, добавление и удаление связей.
- Лента новостей: просмотр сообщений друзей выбранного пользователя, добавление новых сообщений.
- Хранение данных в JSON-файлах (`data/users.json`, `data/friends.json`, `data/messages.json`) с записью при каждом изменении.
- HTTPS-сервер на Express c поддержкой EJS и Bootstrap 5.3, статика подключается из `dist/webpack`, `dist/gulp` или `public`.
- Клиентские стили на SASS (SCSS) с основными возможностями препроцессора: переменные, миксины, вложенность, арифметика.
- Две независимые сборки клиентской части: Gulp и Webpack (результат в `dist/gulp` и `dist/webpack`).
- Скрипт генерации самоподписанного сертификата (`npm run generate:cert`).

## Быстрый старт

1. Установите Node.js версии 18+.
2. Установите зависимости:
   ```bash
   npm install
   ```
3. Сгенерируйте самоподписанный сертификат (создаст файлы в `cert/`):
   ```bash
   npm run generate:cert
   ```
4. Запустите сервер в режиме разработки:
   ```bash
   npm run dev
   ```
5. Откройте https://localhost:3443 (при первом запуске браузер попросит доверить сертификату).

По умолчанию сервер ищет статические файлы в `dist/webpack`, затем в `dist/gulp`, и в крайнем случае в `public/`. После первой сборки они появятся автоматически.

## Структура проекта

```
server/             # Express-приложение и настройки HTTPS
views/              # Шаблоны EJS для работы сервера
src/                # Исходники client-side для сборок
  ├─ scripts/
  ├─ styles/
  └─ templates/
public/             # Готовая статика по умолчанию
cert/               # TLS сертификат и ключ (генерируются локально)
data/               # JSON-файлы с пользователями, друзьями и сообщениями
```

## Работа с данными

- `data/users.json` — список пользователей с полями `fullName`, `birthDate`, `email`, `photo`, `role`, `status`.
- `data/friends.json` — связи между пользователями в формате `{ userId, friends: [] }`.
- `data/messages.json` — лента сообщений друзей.

Все изменения, отправленные через веб-интерфейс, перезаписывают соответствующие файлы. Для резервного копирования достаточно скопировать директорию `data/`.

## Сборка фронтенда

### Gulp

- Полная сборка: `npm run build:gulp`
- Режим разработки с отслеживанием: `npm run build:gulp:watch`

Gulp компилирует SCSS → CSS, транспилирует JS через Babel, минифицирует и копирует ассеты в `dist/gulp`. Дополнительно файлы CSS/JS синхронно складываются в `public/`.

### Webpack

- Продакшен-сборка: `npm run build:webpack`
- Development-сборка (source map): `npm run build:webpack:dev`

Webpack собирает ES6-модули, SCSS, шаблоны EJS и копирует ассеты в `dist/webpack`. HTML-файлы (`users.html`, `friends.html`, `news.html`) генерируются из тех же данных JSON.

## HTTPS и самоподписанный сертификат

Для локального HTTPS установите доверие к сгенерированному сертификату `cert/server.cert`. Для продакшена замените его на действительный сертификат.

## Работа с npm-модулями

- Регистрация (установка) модуля в проект:
  ```bash
  npm install <имя_пакета>
  ```
- Удаление модуля из проекта:
  ```bash
  npm uninstall <имя_пакета>
  ```

Проект уже включает все необходимые зависимости для Express, EJS, Gulp, Webpack и сопутствующих инструментов. Дополнительные пакеты добавляйте по мере надобности.

## Полезные команды

| Команда | Описание |
| --- | --- |
| `npm run dev` | Запуск сервера с hot-reload (nodemon) |
| `npm run start` | Запуск HTTPS сервера без перезапуска при изменениях |
| `npm run generate:cert` | Создание самоподписанного сертификата |
| `npm run build:gulp` | Сборка фронтенда через Gulp |
| `npm run build:webpack` | Сборка фронтенда через Webpack |

## Дополнительно

- Для работы запросов Fetch необходим сервер (`npm run dev`), так как API обращается к эндпоинтам `/api/*`.
- При развертывании в окружении с настоящим HTTPS замените содержимое `cert/` и обновите `process.env.PORT` при необходимости.
- Все файлы настроены под стандарт ES6 (`"type": "module"` в `package.json`).
